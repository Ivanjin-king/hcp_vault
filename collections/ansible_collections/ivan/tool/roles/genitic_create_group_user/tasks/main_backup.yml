---
# tasks file for genitic_create_group_user
- name: Make sure a group named "walle"
  group:
    name: walle
    state: present
- name: Allow "walle" group to have paswordless sudo
  lineinfile:
    dest: /etc/sudoers
    state: present
    regexp: '^%walle'
    line: '%walle ALL=(ALL) NOPASSWD: ALL'
    validate: 'visudo -cf %s'
- name: Add sudoers users to walle group
  user: name=deployer groups=walle append=yes state=present createhome=yes
#- name: Set up authorized keys for the deployer user
#  authorized_key: user=deployer key='{{item}}'
#  with_file:
#    - ~/.ssh/id_rsa.pub
